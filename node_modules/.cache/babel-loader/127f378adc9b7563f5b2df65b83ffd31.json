{"ast":null,"code":"$(function () {\n  $(\".check-custom-redirections\").on(\"click\", function (evt) {\n    evt.preventDefault();\n\n    if ($(evt.target).hasClass(\"disabled\")) {\n      return;\n    }\n\n    $(evt.target).addClass(\"disabled\");\n\n    var getReport = function getReport(tr, response) {\n      var item = $(tr).data(\"item\");\n      var $td = $(tr).find(\".redirect-status\");\n      var type = response.type;\n      var status = response.status;\n\n      if (response.type == \"opaqueredirect\") {\n        type = \"redirect\";\n        status = \"302\";\n      }\n\n      if (item.active) {\n        if (type == \"redirect\") {\n          $td.addClass(\"success\");\n        } else {\n          $td.addClass(\"alert\");\n        }\n      } else {\n        $td.addClass(\"muted\");\n      }\n\n      return \"\".concat(type, \" (\").concat(status, \")\");\n    };\n\n    $(\"tr.custom-redirection\").each(function (index, tr) {\n      var $td = $(tr).find(\".redirect-status\");\n      $td.html('<span class=\"loading-spinner\" />');\n      fetch($(tr).data(\"origin\"), {\n        method: \"HEAD\",\n        redirect: \"manual\"\n      }).then(function (response) {\n        $td.html(getReport(tr, response));\n      })[\"catch\"](function (error) {\n        console.error(\"ERROR\", error);\n        $td.removeClass(\"loading\");\n      });\n    });\n  });\n});","map":{"version":3,"mappings":"AAAAA,CAAC,CAAC,YAAM;EACNA,CAAC,CAAC,4BAAD,CAADA,CAAgCC,EAAhCD,CAAmC,OAAnCA,EAA4C,UAACE,GAAD,EAAS;IACnDA,GAAG,CAACC,cAAJD;;IAEA,IAAIF,CAAC,CAACE,GAAG,CAACE,MAAL,CAADJ,CAAcK,QAAdL,CAAuB,UAAvBA,CAAJ,EAAwC;MACtC;IACD;;IAEDA,CAAC,CAACE,GAAG,CAACE,MAAL,CAADJ,CAAcM,QAAdN,CAAuB,UAAvBA;;IAEA,IAAMO,SAAS,GAAG,SAAZA,SAAY,CAACC,EAAD,EAAKC,QAAL,EAAkB;MAClC,IAAMC,IAAI,GAAGV,CAAC,CAACQ,EAAD,CAADR,CAAMW,IAANX,CAAW,MAAXA,CAAb;MACA,IAAMY,GAAG,GAAGZ,CAAC,CAACQ,EAAD,CAADR,CAAMa,IAANb,CAAW,kBAAXA,CAAZ;MAEA,IAAIc,IAAI,GAAGL,QAAQ,CAACK,IAApB;MACA,IAAIC,MAAM,GAAGN,QAAQ,CAACM,MAAtB;;MACA,IAAIN,QAAQ,CAACK,IAATL,IAAiB,gBAArB,EAAuC;QACrCK,IAAI,GAAG,UAAPA;QACAC,MAAM,GAAG,KAATA;MACD;;MAED,IAAIL,IAAI,CAACM,MAAT,EAAiB;QACf,IAAIF,IAAI,IAAK,UAAb,EAAyB;UACvBF,GAAG,CAACN,QAAJM,CAAa,SAAbA;QADF,OAEO;UACLA,GAAG,CAACN,QAAJM,CAAa,OAAbA;QACD;MALH,OAMO;QACLA,GAAG,CAACN,QAAJM,CAAa,OAAbA;MACD;;MAED,iBAAUE,IAAV,eAAmBC,MAAnB;IArBF;;IAwBAf,CAAC,CAAC,uBAAD,CAADA,CAA2BiB,IAA3BjB,CAAgC,UAACkB,KAAD,EAAQV,EAAR,EAAe;MAC7C,IAAMI,GAAG,GAAGZ,CAAC,CAACQ,EAAD,CAADR,CAAMa,IAANb,CAAW,kBAAXA,CAAZ;MACAY,GAAG,CAACO,IAAJP,CAAS,kCAATA;MACAQ,KAAK,CAACpB,CAAC,CAACQ,EAAD,CAADR,CAAMW,IAANX,CAAW,QAAXA,CAAD,EAAuB;QAACqB,MAAM,EAAE,MAAT;QAAiBC,QAAQ,EAAE;MAA3B,CAAvB,CAALF,CACEG,IADFH,CACO,UAACX,QAAD,EAAc;QACjBG,GAAG,CAACO,IAAJP,CAASL,SAAS,CAACC,EAAD,EAAKC,QAAL,CAAlBG;MAFJ,YAIQ,UAACY,KAAD,EAAW;QACfC,OAAO,CAACD,KAARC,CAAc,OAAdA,EAAuBD,KAAvBC;QACAb,GAAG,CAACc,WAAJd,CAAgB,SAAhBA;MANJ;IAHF;EAjCF;AADD,EAADZ","names":["$","on","evt","preventDefault","target","hasClass","addClass","getReport","tr","response","item","data","$td","find","type","status","active","each","index","html","fetch","method","redirect","then","error","console","removeClass"],"sources":["/home/injam/.rbenv/versions/2.7.5/lib/ruby/gems/2.7.0/gems/decidim-decidim_awesome-0.8.3/app/packs/src/decidim/decidim_awesome/admin/check_redirections.js"],"sourcesContent":["$(() => {\n  $(\".check-custom-redirections\").on(\"click\", (evt) => {\n    evt.preventDefault();\n    \n    if ($(evt.target).hasClass(\"disabled\")) {\n      return;\n    }\n    \n    $(evt.target).addClass(\"disabled\");\n\n    const getReport = (tr, response) => {\n      const item = $(tr).data(\"item\");\n      const $td = $(tr).find(\".redirect-status\");\n\n      let type = response.type;\n      let status = response.status;\n      if (response.type == \"opaqueredirect\") {\n        type = \"redirect\";\n        status = \"302\";\n      }\n\n      if (item.active) {\n        if (type ==  \"redirect\") {\n          $td.addClass(\"success\");\n        } else {\n          $td.addClass(\"alert\");\n        }\n      } else {\n        $td.addClass(\"muted\");\n      }\n\n      return `${type} (${status})`;\n    };\n\n    $(\"tr.custom-redirection\").each((index, tr) => {\n      const $td = $(tr).find(\".redirect-status\");\n      $td.html('<span class=\"loading-spinner\" />');\n      fetch($(tr).data(\"origin\"), {method: \"HEAD\", redirect: \"manual\"}).\n        then((response) => {\n          $td.html(getReport(tr, response))\n        }).\n        catch((error) => {\n          console.error(\"ERROR\", error)  \n          $td.removeClass(\"loading\");\n        });\n    });\n  });\n});\n"]},"metadata":{},"sourceType":"module"}