{"ast":null,"code":"$(function () {\n  var CustomFieldsBuilders = window.CustomFieldsBuilders || [];\n  $(\"body\").on(\"click\", \"a.awesome-auto-edit\", function (e) {\n    e.preventDefault();\n    var $link = $(e.currentTarget);\n    var scope = $link.data(\"scope\");\n    var $target = $(\"span.awesome-auto-edit[data-scope=\\\"\".concat(scope, \"\\\"]\"));\n    var $constraints = $(\".constraints-editor[data-key=\\\"\".concat(scope, \"\\\"]\"));\n\n    if ($target.length == 0) {\n      return;\n    }\n\n    var key = $target.data(\"key\");\n    var attribute = $target.data(\"var\");\n    var $hidden = $(\"[name=\\\"config[\".concat(attribute, \"][\").concat(key, \"]\\\"]\"));\n    var $multiple = $(\"[name=\\\"config[\".concat(attribute, \"][\").concat(key, \"][]\\\"]\"));\n    var $container = $(\".\".concat(attribute, \"_container[data-key=\\\"\").concat(key, \"\\\"]\"));\n    var $delete = $(\".delete-box\", $container);\n\n    var rebuildLabel = function rebuildLabel(text, withScope) {\n      $target.text(text);\n      $target.attr(\"data-key\", text);\n      $target.data(\"key\", text);\n\n      if (withScope) {\n        $target.attr(\"data-scope\", withScope);\n        $target.data(\"scope\", withScope);\n        $link.attr(\"data-scope\", withScope);\n        $link.data(\"scope\", withScope);\n      }\n\n      $link.show();\n    };\n\n    var rebuildHmtl = function rebuildHmtl(result) {\n      rebuildLabel(result.key, result.scope);\n      $constraints.replaceWith(result.html); // update hidden input if exists\n\n      $hidden.attr(\"name\", \"config[\".concat(attribute, \"][\").concat(result.key, \"]\"));\n      $multiple.attr(\"name\", \"config[\".concat(attribute, \"][\").concat(result.key, \"][]\"));\n      $container.data(\"key\", result.key);\n      $container.attr(\"data-key\", result.key);\n      $delete.attr(\"href\", $delete.attr(\"href\").replace(\"key=\".concat(key), \"key=\".concat(result.key)));\n      CustomFieldsBuilders.forEach(function (builder) {\n        if (builder.key == key) {\n          builder.key = result.key;\n        }\n      });\n    };\n\n    $target.html(\"<input class=\\\"awesome-auto-edit\\\" data-scope=\\\"\".concat(scope, \"\\\" type=\\\"text\\\" value=\\\"\").concat(key, \"\\\">\"));\n    var $input = $(\"input.awesome-auto-edit[data-scope=\\\"\".concat(scope, \"\\\"]\"));\n    $link.hide();\n    $input.select();\n    $input.on(\"keypress\", function (evt) {\n      if (evt.code == \"Enter\" || evt.code == \"13\" || evt.code == \"10\") {\n        evt.preventDefault();\n        $.ajax({\n          type: \"POST\",\n          url: DecidimAwesome.rename_scope_label_path,\n          dataType: \"json\",\n          headers: {\n            \"X-CSRF-Token\": $(\"meta[name=csrf-token]\").attr(\"content\")\n          },\n          data: {\n            key: key,\n            scope: scope,\n            attribute: attribute,\n            text: $input.val()\n          }\n        }).done(function (result) {\n          return rebuildHmtl(result);\n        }).fail(function (err) {\n          console.error(\"Error saving key\", key, \"ERR:\", err);\n          rebuildLabel(key);\n        });\n      }\n    });\n    $input.on(\"blur\", function () {\n      rebuildLabel(key);\n    });\n  });\n});","map":{"version":3,"mappings":"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","names":["$","CustomFieldsBuilders","window","on","e","preventDefault","$link","currentTarget","scope","data","$target","$constraints","length","key","attribute","$hidden","$multiple","$container","$delete","rebuildLabel","text","withScope","attr","show","rebuildHmtl","result","replaceWith","html","replace","forEach","builder","$input","hide","select","evt","code","ajax","type","url","DecidimAwesome","rename_scope_label_path","dataType","headers","val","done","fail","err","console","error"],"sources":["/home/injam/.rbenv/versions/2.7.5/lib/ruby/gems/2.7.0/gems/decidim-decidim_awesome-0.8.3/app/packs/src/decidim/decidim_awesome/admin/auto_edit.js"],"sourcesContent":["$(() => {\n  let CustomFieldsBuilders = window.CustomFieldsBuilders || [];\n\n  $(\"body\").on(\"click\", \"a.awesome-auto-edit\", (e) => {\n    e.preventDefault();\n    const $link = $(e.currentTarget);\n    const scope = $link.data(\"scope\");\n    const $target = $(`span.awesome-auto-edit[data-scope=\"${scope}\"]`);\n    const $constraints = $(`.constraints-editor[data-key=\"${scope}\"]`);\n    if ($target.length == 0) {\n      return;\n    }\n\n    const key = $target.data(\"key\");\n    const attribute = $target.data(\"var\");\n    const $hidden = $(`[name=\"config[${attribute}][${key}]\"]`);\n    const $multiple = $(`[name=\"config[${attribute}][${key}][]\"]`);\n    const $container = $(`.${attribute}_container[data-key=\"${key}\"]`);\n    const $delete = $(\".delete-box\", $container);\n\n    const rebuildLabel = (text, withScope) => {\n      $target.text(text);\n      $target.attr(\"data-key\", text);\n      $target.data(\"key\", text);\n      if (withScope) {\n        $target.attr(\"data-scope\", withScope);\n        $target.data(\"scope\", withScope);\n        $link.attr(\"data-scope\", withScope);\n        $link.data(\"scope\", withScope);\n      }\n      $link.show();\n    };\n\n    const rebuildHmtl = (result) => {\n      rebuildLabel(result.key, result.scope);\n      $constraints.replaceWith(result.html);\n      // update hidden input if exists\n      $hidden.attr(\"name\", `config[${attribute}][${result.key}]`);\n      $multiple.attr(\"name\", `config[${attribute}][${result.key}][]`);\n      $container.data(\"key\", result.key);\n      $container.attr(\"data-key\", result.key);\n      $delete.attr(\"href\", $delete.attr(\"href\").replace(`key=${key}`, `key=${result.key}`))\n      CustomFieldsBuilders.forEach((builder) => {\n        if (builder.key == key) {\n          builder.key = result.key;\n        }\n      });\n    };\n\n    $target.html(`<input class=\"awesome-auto-edit\" data-scope=\"${scope}\" type=\"text\" value=\"${key}\">`);\n    const $input = $(`input.awesome-auto-edit[data-scope=\"${scope}\"]`);\n    $link.hide();\n    $input.select();\n    $input.on(\"keypress\", (evt) => {\n      if (evt.code == \"Enter\" || evt.code == \"13\" || evt.code == \"10\") {\n        evt.preventDefault();\n        $.ajax(\n          {\n            type: \"POST\",\n            url: DecidimAwesome.rename_scope_label_path,\n            dataType: \"json\",\n            headers: {\n              \"X-CSRF-Token\": $(\"meta[name=csrf-token]\").attr(\"content\")\n            },\n            data: { key: key,\n              scope: scope,\n              attribute: attribute,\n              text: $input.val()\n            }\n          }).\n          done((result) => rebuildHmtl(result)).\n          fail((err) => {\n            console.error(\"Error saving key\", key, \"ERR:\", err);\n            rebuildLabel(key);\n          });\n      }\n    });\n    $input.on(\"blur\", () => {\n      rebuildLabel(key);\n    });\n  });\n});\n"]},"metadata":{},"sourceType":"module"}