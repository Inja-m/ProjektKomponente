{"ast":null,"code":"import moment from \"moment\";\n$(function () {\n  var $impersonationWarning = $(\".impersonation-warning\");\n\n  if ($impersonationWarning.length) {\n    var endsAt = moment($impersonationWarning.data(\"session-ends-at\"));\n    var exitInterval = setInterval(function () {\n      var diff = (endsAt - moment()) / 60000;\n      var diffInMinutes = Math.round(diff);\n      $impersonationWarning.find(\".minutes\").html(diffInMinutes);\n\n      if (diff <= 0) {\n        window.location.reload();\n      }\n    }, 1000); // Prevent reload when page is already unloading, otherwise it may cause infinite reloads.\n\n    window.addEventListener(\"beforeunload\", function () {\n      clearInterval(exitInterval);\n      return;\n    });\n  }\n});","map":{"version":3,"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AAEAC,CAAC,CAAC,YAAM;EACN,IAAMC,qBAAqB,GAAGD,CAAC,CAAC,wBAAD,CAA/B;;EACA,IAAIC,qBAAqB,CAACC,MAA1B,EAAkC;IAChC,IAAMC,MAAM,GAAGJ,MAAM,CAACE,qBAAqB,CAACG,IAAtBH,CAA2B,iBAA3BA,CAAD,CAArB;IACA,IAAMI,YAAY,GAAGC,WAAW,CAAC,YAAM;MACrC,IAAMC,IAAI,GAAG,CAACJ,MAAM,GAAGJ,MAAM,EAAhB,IAAsB,KAAnC;MACA,IAAMS,aAAa,GAAGC,IAAI,CAACC,KAALD,CAAWF,IAAXE,CAAtB;MACAR,qBAAqB,CAACU,IAAtBV,CAA2B,UAA3BA,EAAuCW,IAAvCX,CAA4CO,aAA5CP;;MAEA,IAAIM,IAAI,IAAI,CAAZ,EAAe;QACbM,MAAM,CAACC,QAAPD,CAAgBE,MAAhBF;MACD;IAP6B,GAQ7B,IAR6B,CAAhC,CAFgC,CAYhC;;IACAA,MAAM,CAACG,gBAAPH,CAAwB,cAAxBA,EAAwC,YAAM;MAC5CI,aAAa,CAACZ,YAAD,CAAbY;MACA;IAFF;EAID;AAnBF,EAADjB","names":["moment","$","$impersonationWarning","length","endsAt","data","exitInterval","setInterval","diff","diffInMinutes","Math","round","find","html","window","location","reload","addEventListener","clearInterval"],"sources":["/home/injam/.rbenv/versions/2.7.5/lib/ruby/gems/2.7.0/gems/decidim-core-0.26.2/app/packs/src/decidim/impersonation.js"],"sourcesContent":["import moment from \"moment\"\n\n$(() => {\n  const $impersonationWarning = $(\".impersonation-warning\");\n  if ($impersonationWarning.length) {\n    const endsAt = moment($impersonationWarning.data(\"session-ends-at\"));\n    const exitInterval = setInterval(() => {\n      const diff = (endsAt - moment()) / 60000;\n      const diffInMinutes = Math.round(diff);\n      $impersonationWarning.find(\".minutes\").html(diffInMinutes);\n\n      if (diff <= 0) {\n        window.location.reload();\n      }\n    }, 1000);\n\n    // Prevent reload when page is already unloading, otherwise it may cause infinite reloads.\n    window.addEventListener(\"beforeunload\", () => {\n      clearInterval(exitInterval);\n      return;\n    });\n  }\n});\n"]},"metadata":{},"sourceType":"module"}